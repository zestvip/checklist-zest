<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Checklist da sua viaagem com a Zest</title>

  <style>
    :root{
      --bg:#B3D9EB; --card:#F9F7E1; --text:#1f1f1f; --muted:#6b7280;
      --line:#e4e2cf; --pill:#f1f2ec; --radius:18px; --shadow:0 6px 18px rgba(0,0,0,.06);
      --accent:#B3D9EB; --deep:#123826;
    }
    *{ box-sizing:border-box; }
    body{ margin:0; background:var(--bg); color:var(--text);
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,Arial,sans-serif; line-height:1.5; padding:18px; }
    .wrap{ max-width:560px; margin:0 auto; }
    .card{ background:var(--card); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden; }
    header{ padding:18px 18px 12px 18px; border-bottom:1px solid var(--line); }
    .brand{ display:flex; justify-content:center; align-items:center; margin-bottom:10px; }
    .brand img{ height:34px; object-fit:contain; display:block; }
    h1{ font-size:18px; margin:0; letter-spacing:.2px; text-align:center; }
    .subtitle{ text-align:center; margin:8px 0 0 0; color:var(--muted); font-size:13px; }

    .actions{ display:flex; gap:10px; padding:12px 18px; border-bottom:1px solid var(--line); flex-wrap:wrap; }
    button{
      border:1px solid var(--line); background:var(--card); padding:10px 12px; border-radius:12px; font-size:14px; cursor:pointer;
      transition:transform .05s ease, background .15s ease, border-color .15s ease;
    }
    button:hover{ background:var(--pill); }
    button:active{ transform:translateY(1px); }
    .ghost{ background:transparent; }
    .ghost:hover{ background:rgba(18,56,38,.06); border-color:rgba(18,56,38,.18); }
    #clearAll{ border-color:rgba(18,56,38,.18); }

    details{ border-bottom:1px solid var(--line); padding:0 18px; }
    summary{
      list-style:none; cursor:pointer; padding:14px 0; display:flex; align-items:center; justify-content:space-between; gap:10px; user-select:none;
    }
    summary::-webkit-details-marker{ display:none; }
    .secTitle{ display:flex; gap:10px; align-items:center; font-weight:800; font-size:15px; color:var(--deep); }
    .count{ font-size:12px; color:var(--muted); background:var(--pill); border:1px solid var(--line); padding:4px 8px; border-radius:999px; white-space:nowrap; }

    /* ‚ÄúCen√°rios‚Äù (condicionais) */
    .scenarios{
      padding:14px 18px 2px 18px;
      border-bottom:1px solid var(--line);
      background:rgba(255,255,255,.20);
    }
    .scTitle{ font-weight:800; color:var(--deep); font-size:14px; margin:0 0 10px 0; }
    .scGrid{ display:grid; grid-template-columns:1fr; gap:10px; padding-bottom:12px; }
    .scGroup{
      border:1px solid rgba(18,56,38,.12);
      border-radius:14px;
      padding:10px 12px;
      background:rgba(255,255,255,.35);
    }
    .scGroupTitle{ font-weight:800; color:var(--deep); font-size:13px; margin:0 0 8px 0; }
    .chips{ display:flex; flex-wrap:wrap; gap:8px; }
    .chip{
      display:flex; align-items:center; gap:8px;
      padding:8px 10px;
      border:1px solid var(--line);
      border-radius:999px;
      background:var(--card);
      font-size:13px;
      cursor:pointer;
      user-select:none;
    }
    .chip input{ width:16px; height:16px; accent-color:var(--accent); }
    .chip small{ color:var(--muted); font-size:12px; }

    .subsection{
      margin:10px 0 0 0;
      padding:10px 12px;
      border:1px solid rgba(18,56,38,.12);
      border-radius:14px;
      background:rgba(255,255,255,.35);
    }
    .subhead{ margin:0 0 10px 0; font-weight:800; color:var(--deep); font-size:13px; letter-spacing:.2px; }

    .items{ padding:0 0 14px 0; display:flex; flex-direction:column; gap:10px; }
    label.item{
      display:flex; gap:10px; align-items:flex-start; padding:10px 10px;
      border:1px solid var(--line); border-radius:14px; background:var(--card);
      transition:background .15s ease, border-color .15s ease;
    }
    label.item:hover{ background:rgba(179,217,235,.22); border-color:rgba(18,56,38,.14); }
    input[type="checkbox"]{ margin-top:3px; width:18px; height:18px; flex:0 0 auto; accent-color:var(--accent); cursor:pointer; }
    .txt{ display:flex; flex-direction:column; gap:2px; }
    .sub{ font-size:12px; color:var(--muted); }
    label.checked{ opacity:.75; }
    label.checked .txt{ text-decoration:line-through; }

    .noteBox{
      border:1px dashed rgba(18,56,38,.25);
      background:rgba(179,217,235,.18);
      padding:10px 12px;
      border-radius:14px;
      font-size:13px;
    }
    .noteBox strong{ color:var(--deep); }

    .notesWrap{ padding:0 18px 18px 18px; border-bottom:1px solid var(--line); }
    .notesTitle{ margin:18px 0 10px 0; font-weight:800; font-size:15px; color:var(--deep); }
    textarea{
      width:100%; min-height:120px; padding:12px; border:1px solid var(--line); border-radius:14px;
      font-size:14px; resize:vertical; outline:none; background:var(--card); color:var(--text);
    }
    textarea:focus{ border-color:rgba(0,189,169,.55); box-shadow:0 0 0 4px rgba(0,189,169,.10); }

    footer{ padding:14px 18px 18px 18px; color:var(--muted); font-size:12px; }
    .sig{ margin-top:12px; color:var(--deep); font-weight:800; line-height:1.35; }
    .pagebreak{ height:12px; }
    @media print{ .pagebreak{ break-before:page; page-break-before:always; } }

    /* Condicionais: escondidos por padr√£o, aparecem quando um cen√°rio est√° ativo */
    .conditional{ display:none; }
    .conditional.show{ display:block; }
    .hint{ color:var(--muted); font-size:12px; margin:8px 0 0 0; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <header>
        <div class="brand">
          <img src="logo-zest-ceu.png" alt="Zest">
        </div>
        <h1>Checklist de Mala</h1>
        <p class="subtitle">
          A Zest quer facilitar sua vida: por isso, fizemos uma pr√©-sele√ß√£o cuidadosa com os itens essenciais da sua mala.
          Marque no celular, fa√ßa anota√ß√µes e volte quando precisar ‚Äî tudo fica salvo neste dispositivo.
        </p>
      </header>

      <!-- CEN√ÅRIOS (condicionais) -->
      <section class="scenarios" id="scenarios">
        <p class="scTitle">Marque aqui o que se aplica √† sua viagem</p>

        <div class="scGrid">
          <div class="scGroup">
            <p class="scGroupTitle">üåç Tipo de viagem</p>
            <div class="chips">
              <label class="chip"><input type="checkbox" data-scenario="trip_nacional"> Viagem nacional</label>
              <label class="chip"><input type="checkbox" data-scenario="trip_internacional"> Viagem internacional</label>
            </div>
            <p class="hint">Voc√™ pode marcar mais de uma op√ß√£o (ex.: internacional + praia + com crian√ßas).</p>
          </div>

          <div class="scGroup">
            <p class="scGroupTitle">üå¶Ô∏è Clima</p>
            <div class="chips">
              <label class="chip"><input type="checkbox" data-scenario="clima_calor"> Calor</label>
              <label class="chip"><input type="checkbox" data-scenario="clima_meia"> Meia-esta√ß√£o</label>
              <label class="chip"><input type="checkbox" data-scenario="clima_frio"> Frio</label>
              <label class="chip"><input type="checkbox" data-scenario="clima_neve"> Neve / esqui</label>
            </div>
          </div>

          <div class="scGroup">
            <p class="scGroupTitle">üèñÔ∏è Tipo de destino</p>
            <div class="chips">
              <label class="chip"><input type="checkbox" data-scenario="dest_praia"> Praia</label>
              <label class="chip"><input type="checkbox" data-scenario="dest_cidade"> Cidade</label>
              <label class="chip"><input type="checkbox" data-scenario="dest_natureza"> Natureza / campo</label>
              <label class="chip"><input type="checkbox" data-scenario="dest_cruzeiro"> Cruzeiro</label>
            </div>
          </div>

          <div class="scGroup">
            <p class="scGroupTitle">üë®‚Äçüë©‚Äçüëß Perfil de quem viaja</p>
            <div class="chips">
              <label class="chip"><input type="checkbox" data-scenario="perfil_bebes"> Com beb√™s (0 a 2 anos)</label>
              <label class="chip"><input type="checkbox" data-scenario="perfil_criancas"> Com crian√ßas (3 a 12 anos)</label>
              <label class="chip"><input type="checkbox" data-scenario="perfil_menor"> Com menor (13 a 17 anos)</label>
              <label class="chip"><input type="checkbox" data-scenario="perfil_trabalho"> A trabalho</label>
            </div>
          </div>
        </div>
      </section>

      <div class="actions">
        <button id="expandAll" class="ghost" type="button">Abrir categorias</button>
        <button id="collapseAll" class="ghost" type="button">Fechar categorias</button>
        <button id="clearAll" type="button">Desmarcar tudo</button>
      </div>

      <!-- 1Ô∏è‚É£ DOCUMENTOS E ITENS PR√ÅTICOS -->
      <details open>
        <summary>
          <div class="secTitle">1Ô∏è‚É£ Documentos e itens pr√°ticos</div>
          <div class="count" data-count="doc">0/0</div>
        </summary>

        <!-- Condicional: Viagem nacional -->
        <div class="subsection conditional" data-show-when="trip_nacional">
          <div class="subhead">Viagem nacional</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="doc_nac_01"><span class="txt">RG, CNH ou carteira de trabalho <span class="sub">(f√≠sico ou digital, sempre no aplicativo oficial), passaporte v√°lido, documentos de classe (OAB, CRM, CREA, COREN etc.) ou DNI.</span></span></label>
            <label class="item"><input type="checkbox" data-id="doc_nac_02"><span class="txt">Cart√£o de cr√©dito f√≠sico <span class="sub">(se for alugar carro)</span></span></label>
            <label class="item"><input type="checkbox" data-id="doc_nac_03"><span class="txt">Dinheiro em esp√©cie <span class="sub">(incluindo trocados para gorjetas)</span></span></label>
            <label class="item"><input type="checkbox" data-id="doc_nac_04"><span class="txt">Comprovantes de reserva <span class="sub">(est√° tudo organizado no app)</span></span></label>
            <label class="item"><input type="checkbox" data-id="doc_nac_05"><span class="txt">Rastreador de bagagem</span></label>
            <label class="item"><input type="checkbox" data-id="doc_nac_06"><span class="txt">Cadeados</span></label>
            <label class="item"><input type="checkbox" data-id="doc_nac_07"><span class="txt">Powerbank</span></label>
            <div class="noteBox"><strong>IMPORTANTE:</strong> A ANAC imp√µe restri√ß√µes ao transporte de power banks em voos. S√£o permitidos somente modelos de at√© <strong>25.000 mAh</strong> e apenas na <strong>bagagem de m√£o</strong>. Acima dessa capacidade, √© preciso verificar as regras da companhia a√©rea antes do embarque.</div>
          </div>
        </div>

        <!-- Condicional: Viagem internacional -->
        <div class="subsection conditional" data-show-when="trip_internacional">
          <div class="subhead">Viagem internacional</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="doc_int_01"><span class="txt">RG com at√© 10 anos de emiss√£o <span class="sub">(caso a viagem seja dentro do Mercosul)</span></span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_02"><span class="txt">Passaporte v√°lido <span class="sub">(com visto, se aplic√°vel, mesmo que em outro passaporte)</span></span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_03"><span class="txt">CNH f√≠sica e Permiss√£o Internacional para Dirigir (PID) <span class="sub">(se for alugar carro)</span></span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_04"><span class="txt">Certificado Internacional de Vacina√ß√£o (CIVD) <span class="sub">(se aplic√°vel)</span></span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_05"><span class="txt">L√≠quidos em frascos de at√© 100 ml dentro de zip lock transparente</span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_06"><span class="txt">Cart√µes de cr√©dito <span class="sub">(inclusive o cart√£o de cr√©dito f√≠sico, se for alugar carro)</span></span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_07"><span class="txt">Cart√µes pr√©-pagos <span class="sub">(Wise, Nomad, etc.)</span></span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_08"><span class="txt">Dinheiro em esp√©cie <span class="sub">(incluindo trocados para gorjetas)</span></span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_09"><span class="txt">Chip internacional ou eSIM</span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_10"><span class="txt">Comprovantes de reserva <span class="sub">(est√° tudo organizado no app)</span></span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_11"><span class="txt">Rastreador de bagagem</span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_12"><span class="txt">Cadeados</span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_13"><span class="txt">Adaptador de tomada</span></label>
            <label class="item"><input type="checkbox" data-id="doc_int_14"><span class="txt">Powerbank</span></label>
            <div class="noteBox"><strong>IMPORTANTE:</strong> A ANAC imp√µe restri√ß√µes ao transporte de power banks em voos. S√£o permitidos somente modelos de at√© <strong>25.000 mAh</strong> e apenas na <strong>bagagem de m√£o</strong>. Acima dessa capacidade, √© preciso verificar as regras da companhia a√©rea antes do embarque.</div>
          </div>
        </div>

        <!-- Placeholder quando nada marcado -->
        <div class="noteBox conditional" data-show-when="__none_trip" style="margin-top:10px;">
          Marque acima se sua viagem √© <strong>nacional</strong> e/ou <strong>internacional</strong> para ver os itens desta se√ß√£o.
        </div>
      </details>

      <!-- 2Ô∏è‚É£ MALA DE M√ÉO -->
      <details>
        <summary>
          <div class="secTitle">2Ô∏è‚É£ Mala de m√£o</div>
          <div class="count" data-count="mao">0/0</div>
        </summary>

        <!-- Condicional: Internacional -->
        <div class="subsection conditional" data-show-when="trip_internacional">
          <div class="subhead">Viagem internacional</div>
          <div class="noteBox" style="margin-bottom:10px;">
            <strong>Lembre-se:</strong> l√≠quidos s√≥ em frascos de at√© 100 ml e dentro de um saco zip lock transparente. <strong>Aeross√≥is s√£o barrados.</strong>
            Na mala de bordo, n√£o leve itens de valor nem laptops, pois pode ser exigido o despacho ‚Äî esses itens devem ir no item pessoal (bolsa ou mochila pequena), que permanece com voc√™ o tempo todo.
          </div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="mao_int_01"><span class="txt">Escova/pasta de dente</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_02"><span class="txt">Desodorante roll-on/creme</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_03"><span class="txt">Hidratante facial/labial</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_04"><span class="txt">Casaco leve</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_05"><span class="txt">Almofada de pesco√ßo, m√°scara de dormir, protetor auricular</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_06"><span class="txt">Livro/Kindle</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_07"><span class="txt">Fone de ouvido</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_08"><span class="txt">Cabo e carregador</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_09"><span class="txt">Adaptador de tomada</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_10"><span class="txt">Caneta</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_11"><span class="txt">Joias/bijuterias</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_13"><span class="txt">√ìculos de grau</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_14"><span class="txt">√ìculos escuros</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_15"><span class="txt">Roupa reserva em caso de extravio <span class="sub">(1 troca completa)</span></span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_16"><span class="txt">Absorvente √≠ntimo</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_17"><span class="txt">Guarda-chuva</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_18"><span class="txt">Medicamentos comuns <span class="sub">(antiem√©tico, antigases, antidiarreico, analg√©sico, antigripal, pastilha, anti√°cido)</span></span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_19"><span class="txt">Medicamentos de uso cont√≠nuo</span></label>
            <label class="item"><input type="checkbox" data-id="mao_int_20"><span class="txt">Medicamentos controlados <span class="sub">(com receita traduzida e CID da doen√ßa)</span></span></label>
          </div>
        </div>

        <!-- Condicional: Nacional -->
        <div class="subsection conditional" data-show-when="trip_nacional">
          <div class="subhead">Viagem nacional</div>
          <div class="noteBox" style="margin-bottom:10px;">
            Na mala de bordo, n√£o leve itens de valor nem laptops, pois pode ser exigido o despacho ‚Äî esses itens devem ir no item pessoal (bolsa ou mochila pequena), que permanece com voc√™ o tempo todo.
          </div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="mao_nac_01"><span class="txt">Casaco leve</span></label>
            <label class="item"><input type="checkbox" data-id="mao_nac_02"><span class="txt">Livro/Kindle</span></label>
            <label class="item"><input type="checkbox" data-id="mao_nac_03"><span class="txt">Fone de ouvido</span></label>
            <label class="item"><input type="checkbox" data-id="mao_nac_04"><span class="txt">Cabo e carregador</span></label>
            <label class="item"><input type="checkbox" data-id="mao_nac_05"><span class="txt">Caneta</span></label>
            <label class="item"><input type="checkbox" data-id="mao_nac_06"><span class="txt">Joias/bijuterias</span></label>
            <label class="item"><input type="checkbox" data-id="mao_nac_07"><span class="txt">Maquiagem</span></label>
            <label class="item"><input type="checkbox" data-id="mao_nac_08"><span class="txt">√ìculos de grau</span></label>
            <label class="item"><input type="checkbox" data-id="mao_nac_09"><span class="txt">√ìculos escuros</span></label>
            <label class="item"><input type="checkbox" data-id="mao_nac_10"><span class="txt">Roupa reserva em caso de extravio <span class="sub">(1 troca completa)</span></span></label>
            <label class="item"><input type="checkbox" data-id="mao_nac_11"><span class="txt">Absorvente √≠ntimo</span></label>
            <label class="item"><input type="checkbox" data-id="mao_nac_12"><span class="txt">Guarda-chuva</span></label>
            <label class="item"><input type="checkbox" data-id="mao_nac_13"><span class="txt">Medicamentos comuns, de uso cont√≠nuo e controlados</span></label>
          </div>
        </div>

        <div class="noteBox conditional" data-show-when="__none_trip" style="margin-top:10px;">
          Marque acima se sua viagem √© <strong>nacional</strong> e/ou <strong>internacional</strong> para ver os itens desta se√ß√£o.
        </div>
      </details>

      <!-- 4Ô∏è‚É£ NECESSAIRES -->
      <details>
        <summary>
          <div class="secTitle">4Ô∏è‚É£ Necessaires dentro da mala</div>
          <div class="count" data-count="nec">0/0</div>
        </summary>

        <div class="subsection">
          <div class="subhead">Necessaire banho <span style="font-weight:700;color:var(--muted);"></span></div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="nec_banho_01"><span class="txt">Shampoo</span></label>
            <label class="item"><input type="checkbox" data-id="nec_banho_02"><span class="txt">Condicionador</span></label>
            <label class="item"><input type="checkbox" data-id="nec_banho_03"><span class="txt">Sabonete</span></label>
            <label class="item"><input type="checkbox" data-id="nec_banho_04"><span class="txt">Esponja</span></label>
            <label class="item"><input type="checkbox" data-id="nec_banho_05"><span class="txt">Escova/pasta de dente</span></label>
            <label class="item"><input type="checkbox" data-id="nec_banho_06"><span class="txt">Fio dental/enxaguante bucal</span></label>
          </div>
        </div>

        <div class="subsection" style="margin-top:12px;">
          <div class="subhead">Necessaire de cuidados <span style="font-weight:700;color:var(--muted);"></span></div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="nec_cuid_01"><span class="txt">Leave-in</span></label>
            <label class="item"><input type="checkbox" data-id="nec_cuid_02"><span class="txt">Hidratante corporal</span></label>
            <label class="item"><input type="checkbox" data-id="nec_cuid_03"><span class="txt">Skincare <span class="sub">(hidratante, limpador, demaquilante)</span></span></label>
            <label class="item"><input type="checkbox" data-id="nec_cuid_04"><span class="txt">Protetor solar <span class="sub">(facial e corporal)</span></span></label>
            <label class="item"><input type="checkbox" data-id="nec_cuid_05"><span class="txt">Desodorante <span class="sub">(pode ser aerossol)</span></span></label>
            <label class="item"><input type="checkbox" data-id="nec_cuid_06"><span class="txt">Desodorante para os p√©s</span></label>
            <label class="item"><input type="checkbox" data-id="nec_cuid_07"><span class="txt">Cotonete</span></label>
          </div>
        </div>

        <div class="subsection" style="margin-top:12px;">
          <div class="subhead">Necessaire de beleza <span style="font-weight:700;color:var(--muted);"></span></div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="nec_bel_01"><span class="txt">Escova/pente</span></label>
            <label class="item"><input type="checkbox" data-id="nec_bel_02"><span class="txt">Prendedores de cabelo</span></label>
            <label class="item"><input type="checkbox" data-id="nec_bel_03"><span class="txt">Perfume</span></label>
            <label class="item"><input type="checkbox" data-id="nec_bel_04"><span class="txt">Lente de contato, estojo, liquido</span></label>
            <label class="item"><input type="checkbox" data-id="nec_bel_05"><span class="txt">Maquiagem</span></label>
          </div>
        </div>

        <div class="subsection" style="margin-top:12px;">
          <div class="subhead">Necessaire de emerg√™ncias <span style="font-weight:700;color:var(--muted);"></span></div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="nec_em_01"><span class="txt">Pin√ßa/lixa de unha</span></label>
            <label class="item"><input type="checkbox" data-id="nec_em_02"><span class="txt">Kit de primeiros-socorros <span class="sub">(band-aid, esparadrapo, antiss√©ptico, gaze)</span></span></label>
            <label class="item"><input type="checkbox" data-id="nec_em_03"><span class="txt">Saquinhos pl√°sticos</span></label>
            <label class="item"><input type="checkbox" data-id="nec_em_04"><span class="txt">Porta-roupa suja</span></label>
            <label class="item"><input type="checkbox" data-id="nec_em_05"><span class="txt">Repelente</span></label>
          </div>
        </div>
      </details>

      <!-- 5Ô∏è‚É£ ROUPAS (condicionais por clima/destino/perfil) -->
      <details>
        <summary>
          <div class="secTitle">5Ô∏è‚É£ Roupas</div>
          <div class="count" data-count="r">0/0</div>
        </summary>

        <!-- EM TODOS -->
        <div class="subsection">
          <div class="subhead">√çntimos <span style="font-weight:700;color:var(--muted);"></span></div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_all_01"><span class="txt">Roupas de baixo <span class="sub">(calcinha, cueca, suti√£)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_all_02"><span class="txt">Meias</span></label>
            <label class="item"><input type="checkbox" data-id="r_all_03"><span class="txt">Pijama/camisola</span></label>
            <label class="item"><input type="checkbox" data-id="r_all_04"><span class="txt">Roupa de banho <span class="sub">(√© sempre bom levar, para idas √† piscina do hotel ou ao spa)</span></span></label>
          </div>
        </div>

        <div class="subsection" style="margin-top:12px;">
          <div class="subhead">Acess√≥rios <span style="font-weight:700;color:var(--muted);"></span></div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_all_05"><span class="txt">Chinelo</span></label>
            <label class="item"><input type="checkbox" data-id="r_all_06"><span class="txt">Sapato/bota/sand√°lia/t√™nis</span></label>
            <label class="item"><input type="checkbox" data-id="r_all_07"><span class="txt">Bolsa</span></label>
            <label class="item"><input type="checkbox" data-id="r_all_08"><span class="txt">Acess√≥rios vers√°teis <span class="sub">(len√ßos, cintos)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_all_09"><span class="txt">Top/cal√ßa/blusa/t√™nis de academia</span></label>
          </div>
        </div>

        <!-- Condicional: Calor OU Meia-esta√ß√£o -->
        <div class="subsection conditional" data-show-when="clima_calor clima_meia">
          <div class="subhead">Destinos de calor/meia-esta√ß√£o</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_calor_01"><span class="txt">Casaco fino <span class="sub">(para o ar-condicionado)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_calor_02"><span class="txt">Saia/shorts/bermuda</span></label>
            <label class="item"><input type="checkbox" data-id="r_calor_03"><span class="txt">Cal√ßa</span></label>
            <label class="item"><input type="checkbox" data-id="r_calor_04"><span class="txt">Camisetas e blusas</span></label>
          </div>
        </div>

        <!-- Condicional: Praia -->
        <div class="subsection conditional" data-show-when="dest_praia">
          <div class="subhead">Praia/piscina <span style="font-weight:700;color:var(--muted);"></span></div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_praia_01"><span class="txt">Bolsa de praia</span></label>
            <label class="item"><input type="checkbox" data-id="r_praia_02"><span class="txt">Sa√≠da de praia</span></label>
            <label class="item"><input type="checkbox" data-id="r_praia_03"><span class="txt">Chap√©u/bon√©</span></label>
            <label class="item"><input type="checkbox" data-id="r_praia_04"><span class="txt">Blusa anti-UV</span></label>
            <label class="item"><input type="checkbox" data-id="r_praia_05"><span class="txt">Shampoo e condicionador p√≥s-sol / hidratante corporal refor√ßado</span></label>
            <label class="item"><input type="checkbox" data-id="r_praia_06"><span class="txt">Sacos para roupas molhadas</span></label>
          </div>
        </div>

        <!-- Condicional: Frio -->
        <div class="subsection conditional" data-show-when="clima_frio">
          <div class="subhead">Destinos de frio</div>
          <div class="noteBox" style="margin-bottom:10px;"><strong>Dica:</strong> O segredo para se vestir bem no frio est√° nas camadas ‚Äì f√°ceis de colocar, f√°ceis de tirar.</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_frio_01"><span class="txt">Luva</span></label>
            <label class="item"><input type="checkbox" data-id="r_frio_02"><span class="txt">Touca</span></label>
            <label class="item"><input type="checkbox" data-id="r_frio_03"><span class="txt">Cachecol</span></label>
            <label class="item"><input type="checkbox" data-id="r_frio_04"><span class="txt">Meia-cal√ßa</span></label>
            <label class="item"><input type="checkbox" data-id="r_frio_05"><span class="txt">Segunda pele t√©rmica</span></label>
            <label class="item"><input type="checkbox" data-id="r_frio_06"><span class="txt">Malhas, su√©teres e blusas quentes</span></label>
            <label class="item"><input type="checkbox" data-id="r_frio_07"><span class="txt">Casaco pesado imperme√°vel</span></label>
            <label class="item"><input type="checkbox" data-id="r_frio_08"><span class="txt">Cal√ßa t√©rmica</span></label>
            <label class="item"><input type="checkbox" data-id="r_frio_09"><span class="txt">Bota imperme√°vel</span></label>
            <label class="item"><input type="checkbox" data-id="r_frio_10"><span class="txt">Saco de compress√£o <span class="sub">(para roupas volumosas)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_frio_11"><span class="txt">Hidratante labial, creme para as m√£os <span class="sub">(para deixar na bolsa)</span></span></label>
          </div>
        </div>

        <!-- Condicional: Neve -->
        <div class="subsection conditional" data-show-when="clima_neve">
          <div class="subhead">Neve <span style="font-weight:700;color:var(--muted);"></span></div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_neve_01"><span class="txt">Luvas imperme√°veis</span></label>
            <label class="item"><input type="checkbox" data-id="r_neve_02"><span class="txt">√ìculos de neve / √≥culos de sol com boa prote√ß√£o</span></label>
            <label class="item"><input type="checkbox" data-id="r_neve_03"><span class="txt">Protetor solar <span class="sub">(o reflexo na neve engana!)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_neve_04"><span class="txt">Meias t√©rmicas</span></label>
          </div>
        </div>

        <!-- Condicional: Natureza -->
        <div class="subsection conditional" data-show-when="dest_natureza">
          <div class="subhead">Natureza/trilhas</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_nat_01"><span class="txt">Repelente</span></label>
            <label class="item"><input type="checkbox" data-id="r_nat_02"><span class="txt">T√™nis/bota confort√°vel para trilhas</span></label>
          </div>
        </div>

        <!-- Condicional: Cruzeiro -->
        <div class="subsection conditional" data-show-when="dest_cruzeiro clima_calor clima_meia">
          <div class="subhead">Cruzeiro no calor</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_cru_cal_01"><span class="txt">Rem√©dio para enjoo <span class="sub">(converse com seu m√©dico)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_cru_cal_02"><span class="txt">Roupa e sapato mais formais para noite/jantar <span class="sub">(se o cruzeiro pedir)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_cru_cal_03"><span class="txt">Agasalhos mais grossos <span class="sub">(caso esfrie ‚Äî costuma acontecer √† noite em alto-mar)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_cru_cal_04"><span class="txt">Sapatos confort√°veis <span class="sub">(papetes ou rasteirinhas)</span></span></label>
          </div>
        </div>

        <div class="subsection conditional" data-show-when="dest_cruzeiro clima_frio clima_neve">
          <div class="subhead">Cruzeiro no frio</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_cru_fr_01"><span class="txt">Rem√©dio para enjoo <span class="sub">(converse com seu m√©dico)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_cru_fr_02"><span class="txt">Roupa e sapato mais formais para noite/jantar <span class="sub">(se o cruzeiro pedir)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_cru_fr_03"><span class="txt">Roupa confort√°vel e quente</span></label>
          </div>
        </div>

        <!-- Condicional: Beb√™s -->
        <div class="subsection conditional" data-show-when="perfil_bebes">
          <div class="subhead">Com beb√™s (0‚Äì2 anos)</div>
          <div class="noteBox" style="margin-bottom:10px;">Tudo que for l√≠quido tem que ter no m√°ximo <strong>100 ml</strong> e estar dentro do <strong>zip lock transparente</strong>.</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_bebe_01"><span class="txt">Fraldas / len√ßos de papel e umedecidos / trocador / forro de trocador</span></label>
            <label class="item"><input type="checkbox" data-id="r_bebe_02"><span class="txt">Mamadeira</span></label>
            <label class="item"><input type="checkbox" data-id="r_bebe_03"><span class="txt">Leite em p√≥ / f√≥rmula</span></label>
            <label class="item"><input type="checkbox" data-id="r_bebe_04"><span class="txt">Hora do soninho <span class="sub">(paninho, chupeta, pel√∫cia, etc.)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_bebe_05"><span class="txt">Petiscos <span class="sub">(bolachas, salgadinhos, chocolates, sucos de caixinha)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_bebe_06"><span class="txt">Papinhas <span class="sub">(tamb√©m podem ser aquecidas a bordo)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_bebe_07"><span class="txt">Medicamentos essenciais <span class="sub">(analg√©sico, antit√©rmico, antiem√©tico, term√¥metro ‚Äî converse com o pediatra)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_bebe_08"><span class="txt">Duas mudas de roupas <span class="sub">(para a crian√ßa e tamb√©m para os adultos)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_bebe_09"><span class="txt">Entretenimento para o caminho <span class="sub">(livrinhos, brinquedos silenciosos, kits de desenho, tablet com fone de ouvido)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_bebe_10"><span class="txt">Documentos da crian√ßa <span class="sub">(RG/passaporte com visto, se necess√°rio)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_bebe_11"><span class="txt">C√≥pia autenticada da certid√£o de nascimento <span class="sub">(uma garantia extra)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_bebe_12"><span class="txt">Autoriza√ß√£o de viagem para menor <span class="sub">(se necess√°rio)</span></span></label>
          </div>
        </div>

        <!-- Condicional: Crian√ßas -->
        <div class="subsection conditional" data-show-when="perfil_criancas">
          <div class="subhead">Com crian√ßas (3‚Äì12 anos)</div>
          <div class="noteBox" style="margin-bottom:10px;">Tudo que for l√≠quido tem que ter no m√°ximo <strong>100 ml</strong> e estar dentro do <strong>zip lock transparente</strong>.</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_cri_01"><span class="txt">Documentos da crian√ßa <span class="sub">(RG/passaporte com visto, se necess√°rio)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_cri_02"><span class="txt">Autoriza√ß√£o de viagem para menor <span class="sub">(se necess√°rio)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_cri_03"><span class="txt">Len√ßos de papel e umedecidos</span></label>
            <label class="item"><input type="checkbox" data-id="r_cri_04"><span class="txt">Petiscos <span class="sub">(bolachas, salgadinhos, chocolates, sucos de caixinha)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_cri_05"><span class="txt">Entretenimento para o caminho <span class="sub">(livrinhos, brinquedos silenciosos, kits de desenho, tablet com fone de ouvido)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_cri_06"><span class="txt">Medicamentos essenciais <span class="sub">(analg√©sico, antit√©rmico, antiem√©tico, term√¥metro ‚Äî converse com o pediatra)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_cri_07"><span class="txt">Duas mudas de roupas <span class="sub">(para a crian√ßa e tamb√©m para os adultos)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_cri_08"><span class="txt">C√≥pia autenticada da certid√£o de nascimento <span class="sub">(uma garantia extra)</span></span></label>
          </div>
        </div>

        <!-- Condicional: Menor 13‚Äì17 -->
        <div class="subsection conditional" data-show-when="perfil_menor">
          <div class="subhead">Com menores de idade (13 a 17 anos)</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_adol_01"><span class="txt">Autoriza√ß√£o de viagem</span></label>
          </div>
        </div>

        <!-- Condicional: Trabalho -->
        <div class="subsection conditional" data-show-when="perfil_trabalho">
          <div class="subhead">A trabalho</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="r_work_01"><span class="txt">Cart√£o corporativo</span></label>
            <label class="item"><input type="checkbox" data-id="r_work_02"><span class="txt">Cart√£o de visitas</span></label>
            <label class="item"><input type="checkbox" data-id="r_work_03"><span class="txt">Materiais de trabalho</span></label>
            <label class="item"><input type="checkbox" data-id="r_work_04"><span class="txt">Documentos salvos offline e em nuvem</span></label>
            <label class="item"><input type="checkbox" data-id="r_work_05"><span class="txt">Laptop, mouse e carregador</span></label>
            <label class="item"><input type="checkbox" data-id="r_work_06"><span class="txt">Bloco de notas e caneta</span></label>
            <label class="item"><input type="checkbox" data-id="r_work_07"><span class="txt">Roupas sociais <span class="sub">(camisas, cal√ßas, vestidos)</span></span></label>
            <label class="item"><input type="checkbox" data-id="r_work_08"><span class="txt">Blazer ou casaco formal</span></label>
            <label class="item"><input type="checkbox" data-id="r_work_09"><span class="txt">Sapato social</span></label>
            <label class="item"><input type="checkbox" data-id="r_work_10"><span class="txt">Roupas casuais para o tempo livre</span></label>
          </div>
        </div>
      </details>

      <!-- 6Ô∏è‚É£ ANTES DO EMBARQUE (condicional: aparece sempre) -->
      <details>
        <summary>
          <div class="secTitle">6Ô∏è‚É£ Antes do embarque</div>
          <div class="count" data-count="pre">0/0</div>
        </summary>

        <div class="subsection">
          <div class="subhead">1 m√™s antes</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="pre_01"><span class="txt">Comece a planejar sua bagagem <span class="sub">(revise o que pretende levar e veja se precisa comprar algo)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_02"><span class="txt">Caso tenha filhos, cancele ou reagende atividades e aulas <span class="sub">(que coincidam com o per√≠odo da viagem)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_03"><span class="txt">Suspenda entregas regulares <span class="sub">(correios, jornais, assinaturas de supermercado, hortifruti, etc.)</span></span></label>
          </div>
        </div>

        <div class="subsection" style="margin-top:12px;">
          <div class="subhead">1 semana antes</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="pre_04"><span class="txt">Compartilhe seu roteiro com amigos ou familiares <span class="sub">(a Zest te entrega o arquivo prontinho para isso)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_05"><span class="txt">Saque dinheiro na moeda do destino <span class="sub">(e, se for o caso, tamb√©m em d√≥lares), incluindo notas pequenas para gorjetas</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_06"><span class="txt">Reserve estacionamento no aeroporto ou agende seu t√°xi <span class="sub">(com anteced√™ncia)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_07"><span class="txt">Deixe a vida dos pets resolvida <span class="sub">(pet sitter, hotelzinho, ra√ß√£o, rotina e combinados)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_08"><span class="txt">Confira se algum medicamento controlado precisa de receita especial <span class="sub">(para a viagem)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_09"><span class="txt">Reponha medicamentos de uso cont√≠nuo e organize receitas <span class="sub">(se precisar apresent√°-las durante o trajeto)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_10"><span class="txt">Entregue o PDF da Zest com os dados da sua viagem <span class="sub">(a algu√©m de confian√ßa)</span></span></label>
          </div>
        </div>

        <div class="subsection" style="margin-top:12px;">
          <div class="subhead">1 a 2 dias antes</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="pre_11"><span class="txt">Separe documentos e itens essenciais em um √∫nico local <span class="sub">(passaporte, cart√µes, medicamentos, etc.)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_12"><span class="txt">Carregue todos os dispositivos eletr√¥nicos e baterias port√°teis</span></label>
            <label class="item"><input type="checkbox" data-id="pre_13"><span class="txt">Fa√ßa o check-in do voo e salve o cart√£o de embarque no celular <span class="sub">(se suas passagens foram emitidas pela Zest, pode relaxar ‚Äî n√≥s cuidamos dessa etapa para voc√™)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_14"><span class="txt">Ative ou adquira um plano de dados m√≥veis internacional <span class="sub">(o eSIM √© a op√ß√£o mais pr√°tica: pode ser comprado e ativado online antes da viagem)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_15"><span class="txt">Avise o banco sobre o uso do cart√£o no exterior <span class="sub">(se aplic√°vel)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_16"><span class="txt">Baixe aplicativos √∫teis e conte√∫dos offline <span class="sub">(mapas, tradutores, transporte local, filmes, livros, s√©ries ou playlists)</span></span></label>
          </div>
        </div>

        <div class="subsection" style="margin-top:12px;">
          <div class="subhead">No dia da viagem</div>
          <div class="items" style="padding:0;">
            <label class="item"><input type="checkbox" data-id="pre_17"><span class="txt">Releia seu itiner√°rio Zest <span class="sub">(para confirmar hor√°rios de embarque e transfer)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_18"><span class="txt">Regue as plantas</span></label>
            <label class="item"><input type="checkbox" data-id="pre_19"><span class="txt">Feche as cortinas voltadas para a rua e trave todas as janelas</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_20"><span class="txt">Tire fotos do fog√£o, forno e portas trancadas <span class="sub">(um truque simples que evita d√∫vidas depois)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_21"><span class="txt">Descarte alimentos perec√≠veis que n√£o durem at√© a volta</span></label>
            <label class="item"><input type="checkbox" data-id="pre_22"><span class="txt">Tire o lixo antes de sair</span></label>
            <label class="item"><input type="checkbox" data-id="pre_23"><span class="txt">Feche todas as janelas</span></label>
            <label class="item"><input type="checkbox" data-id="pre_24"><span class="txt">Tranque bem portas e port√µes</span></label>
            <label class="item"><input type="checkbox" data-id="pre_25"><span class="txt">Ative o alarme <span class="sub">(se houver)</span></span></label>
            <label class="item"><input type="checkbox" data-id="pre_26"><span class="txt">Documentos em m√£os? <span class="sub">Agora √© s√≥ curtir!</span></span></label>
          </div>
        </div>
      </details>

      <!-- ANOTA√á√ïES -->
      <div class="notesWrap">
        <div class="notesTitle">üìù Anota√ß√µes</div>
        <textarea id="notesText" placeholder="Escreva aqui observa√ß√µes, itens para comprar, ideias de looks, etc."></textarea>
      </div>

      <footer>
        As marca√ß√µes e anota√ß√µes ficam salvas neste celular/navegador.
        <div class="pagebreak"></div>
        <div class="sig">
          <strong>Zest Est√∫dio de Viagens de Luxo.</strong><br>
          <strong>O puro prazer de viajar.</strong>
          <strong>üíé</strong>
        </div>
      </footer>
    </div>
  </div>

  <script>
    // Chave por p√°gina (evita misturar com vers√µes antigas/arquivos diferentes)
    const pageKey = "zest__" + (location.pathname.split("/").pop() || "index") + "__v6__";

    // --- Helpers storage ---
    const lsGet = (k) => localStorage.getItem(k);
    const lsSet = (k,v) => localStorage.setItem(k, v);
    const lsDel = (k) => localStorage.removeItem(k);

    // --- Cen√°rios (condicionais) ---
    const scenarioBoxes = Array.from(document.querySelectorAll('input[type="checkbox"][data-scenario]'));
    const scenarioKeyPrefix = pageKey + "scenario__";

    function getActiveScenarios(){
      const active = new Set();
      scenarioBoxes.forEach(cb => { if(cb.checked) active.add(cb.dataset.scenario); });
      return active;
    }

    function saveScenario(cb){
      lsSet(scenarioKeyPrefix + cb.dataset.scenario, cb.checked ? "true" : "false");
    }

    function loadScenarios(){
      scenarioBoxes.forEach(cb => {
        const v = lsGet(scenarioKeyPrefix + cb.dataset.scenario);
        cb.checked = (v === "true");
      });
    }

    function applyConditionals(){
      const active = getActiveScenarios();

      // Regras ‚Äúespecial‚Äù para placeholders de tipo de viagem (quando nenhum dos dois est√° marcado)
      const noneTrip = !(active.has("trip_nacional") || active.has("trip_internacional"));
      document.querySelectorAll('[data-show-when="__none_trip"]').forEach(el=>{
        el.classList.toggle("show", noneTrip);
      });

      // Mostra se o elemento tem ao menos 1 tag ativa
      document.querySelectorAll(".conditional[data-show-when]").forEach(el=>{
        const rule = (el.getAttribute("data-show-when") || "").trim();
        if(rule === "__none_trip") return;

        // regra pode conter v√°rias tags separadas por espa√ßo (OR)
        const tags = rule.split(/\s+/).filter(Boolean);

        // caso especial: ‚ÄúCruzeiro no calor‚Äù precisa de cruzeiro E (calor OU meia)
        // Como est√° no HTML: data-show-when="dest_cruzeiro clima_calor clima_meia"
        // Para ficar fiel ao ‚Äúcen√°rio‚Äù, aplicamos:
        // - Se incluir dest_cruzeiro, exigimos dest_cruzeiro e (qualquer outra tag presente OU s√≥ dest_cruzeiro)
        const requiresCruise = tags.includes("dest_cruzeiro");
        if(requiresCruise){
          const others = tags.filter(t => t !== "dest_cruzeiro");
          const ok = active.has("dest_cruzeiro") && (others.length === 0 || others.some(t => active.has(t)));
          el.classList.toggle("show", ok);
          return;
        }

        // padr√£o: OR simples
        const ok = tags.some(t => active.has(t));
        el.classList.toggle("show", ok);
      });

      updateCounts(); // recalc baseado no que est√° vis√≠vel (ver fun√ß√£o abaixo)
    }

    scenarioBoxes.forEach(cb=>{
      cb.addEventListener("change", ()=>{
        saveScenario(cb);
        applyConditionals();
      });
    });

    // --- Anota√ß√µes (texto) ---
    const notesText = document.getElementById("notesText");
    notesText.value = lsGet(pageKey + "notesText") || "";
    notesText.addEventListener("input", () => {
      lsSet(pageKey + "notesText", notesText.value);
    });

    // --- Checkboxes de itens (com mem√≥ria + riscar) ---
    const itemBoxes = Array.from(document.querySelectorAll('input[type="checkbox"][data-id]'));

    function syncStrike(box){
      const lab = box.closest("label");
      if(!lab) return;
      lab.classList.toggle("checked", box.checked);
    }

    itemBoxes.forEach(box => {
      const key = pageKey + box.dataset.id;
      box.checked = lsGet(key) === "true";
      syncStrike(box);

      box.addEventListener("change", () => {
        lsSet(key, box.checked ? "true" : "false");
        syncStrike(box);
        updateCounts();
      });
    });

    // --- Contadores (conta apenas itens VIS√çVEIS) ---
    function updateCounts(){
      document.querySelectorAll("[data-count]").forEach(el=>{
        const prefix = el.getAttribute("data-count");

        // pega somente inputs de itens (data-id) cujo id come√ßa com o prefixo
        const group = itemBoxes.filter(b => (b.dataset.id || "").startsWith(prefix));

        // conta s√≥ os que est√£o vis√≠veis (n√£o dentro de .conditional escondida)
        const visibleGroup = group.filter(b => {
          const parentConditional = b.closest(".conditional");
          if(!parentConditional) return true;
          return parentConditional.classList.contains("show");
        });

        const done = visibleGroup.filter(b => b.checked).length;
        el.textContent = `${done}/${visibleGroup.length}`;
      });
    }

    // --- Abrir / fechar tudo ---
    const allDetails = Array.from(document.querySelectorAll("details"));
    document.getElementById("expandAll").addEventListener("click", () => {
      allDetails.forEach(d => d.open = true);
    });
    document.getElementById("collapseAll").addEventListener("click", () => {
      allDetails.forEach(d => d.open = false);
    });

    // --- Desmarcar tudo (zera cen√°rios + itens + notas) ---
    document.getElementById("clearAll").addEventListener("click", () => {
      if(!confirm("Desmarcar tudo (cen√°rios + checklist) e apagar as anota√ß√µes desta p√°gina?")) return;

      // cen√°rios
      scenarioBoxes.forEach(cb=>{
        lsDel(scenarioKeyPrefix + cb.dataset.scenario);
        cb.checked = false;
      });

      // itens
      itemBoxes.forEach(box=>{
        lsDel(pageKey + box.dataset.id);
        box.checked = false;
        syncStrike(box);
      });

      // notas
      lsDel(pageKey + "notesText");
      notesText.value = "";

      applyConditionals();
      updateCounts();
    });

    // init
    loadScenarios();
    applyConditionals();
    updateCounts();
  </script>
</body>
</html>
